{"version":3,"sources":["../src/personal_menu.js"],"names":["define","$","log","Y","courseCards","util","ajaxNotify","PersonalMenu","self","redirectToSitePolicy","update","redirect","M","cfg","wwwroot","window","location","reqCourseInfo","getCourseIds","focus","loadAjaxInfo","type","container","length","cacheKey","sesskey","supportsSessionStorage","sessionStorage","info","html","ajax","async","url","context","success","data","ifErrorShowBestMsg","done","errorShown","attr","err","clear","error","document","trigger","dispatchEvent","Event","message","evt","createEvent","initEvent","mobilePersonalMenuListeners","getSectionCoords","href","sections","sectionWidth","outerWidth","section","targetSection","index","position","sectionHeight","outerHeight","winHeight","height","left","on","innerWidth","removeAttr","closest","prependTo","activeLink","appendTo","posHeight","css","e","getAttribute","animate","scrollTop","removeClass","addClass","preventDefault","applyListeners","event","toggleClass","is","init","sitePolicyAcceptReqd"],"mappings":"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","sourcesContent":["/**\n * This file is part of Moodle - http://moodle.org/\n *\n * Moodle is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * Moodle is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n *\n * @package   theme_charteredcollege\n * @copyright Copyright (c) 2016 Blackboard Inc. (http://www.blackboard.com)\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/**\n * charteredcollege Personal menu.\n */\ndefine(['jquery', 'core/log', 'core/yui', 'theme_charteredcollege/pm_course_cards', 'theme_charteredcollege/util', 'theme_charteredcollege/ajax_notification'],\n    function($, log, Y, courseCards, util, ajaxNotify) {\n\n        /**\n         * Personal Menu (courses menu).\n         * @constructor\n         */\n        var PersonalMenu = function() {\n\n            var self = this;\n\n            var redirectToSitePolicy = false;\n\n            /**\n             * Add deadlines, messages, grades & grading,  async'ly to the personal menu\n             *\n             */\n            this.update = function() {\n\n                // If site policy needs acceptance, then don't update, just redirect to site policy!\n                if (redirectToSitePolicy) {\n                    var redirect = M.cfg.wwwroot + '/user/policy.php';\n                    window.location = redirect;\n                    return;\n                }\n\n                // Update course cards with info.\n                courseCards.reqCourseInfo(courseCards.getCourseIds());\n\n\n                $('#charteredcollege-pm').focus();\n\n                /**\n                 * Load ajax info into personal menu.\n                 * @param {string} type\n                 */\n                var loadAjaxInfo = function(type) {\n                    // Target for data to be displayed on screen.\n                    var container = $('#charteredcollege-personal-menu-' + type);\n                    if ($(container).length) {\n                        var cacheKey = M.cfg.sesskey + 'personal-menu-' + type;\n                        try {\n                            // Display old content while waiting\n                            if (util.supportsSessionStorage() && window.sessionStorage[cacheKey]) {\n                                log.info('using locally stored ' + type);\n                                var html = window.sessionStorage[cacheKey];\n                                $(container).html(html);\n                            }\n                            log.info('fetching ' + type);\n                            $.ajax({\n                                type: \"GET\",\n                                async: true,\n                                url: M.cfg.wwwroot + '/theme/charteredcollege/rest.php?action=get_' + type + '&contextid=' + M.cfg.context,\n                                success: function(data) {\n                                    ajaxNotify.ifErrorShowBestMsg(data).done(function(errorShown) {\n                                        if (errorShown) {\n                                            return;\n                                        } else {\n                                            // No errors, update sesion storage.\n                                            log.info('fetched ' + type);\n                                            if (util.supportsSessionStorage() && typeof (data.html) != 'undefined') {\n                                                window.sessionStorage[cacheKey] = data.html;\n                                            }\n                                            // Note: we can't use .data because that does not manipulate the dom, we need the data\n                                            // attribute populated immediately so things like behat can utilise it.\n                                            // .data just sets the value in memory, not the dom.\n                                            $(container).attr('data-content-loaded', '1');\n                                            $(container).html(data.html);\n                                        }\n                                    });\n                                }\n                            });\n                        } catch (err) {\n                            sessionStorage.clear();\n                            log.error(err);\n                        }\n                    }\n                };\n\n                loadAjaxInfo('deadlines');\n                loadAjaxInfo('graded');\n                loadAjaxInfo('grading');\n                loadAjaxInfo('messages');\n                loadAjaxInfo('forumposts');\n\n                $(document).trigger('charteredcollegeUpdatePersonalMenu');\n\n                // Triggering event for external PM open listeners.\n                // Try/catch added to ensure browser compatibility for webcomponents.\n                try {\n                    document.dispatchEvent(new Event('charteredcollegePersonalMenuOpen'));\n                } catch(error) {\n                    log.error(error.message);\n                    try {\n                        var evt = document.createEvent(\"Event\");\n                        evt.initEvent('charteredcollegePersonalMenuOpen', true, true);\n                        document.dispatchEvent(evt);\n                    } catch(err) {\n                        log.error(err.message);\n                    }\n                }\n            };\n\n            /**\n             * Apply listeners for personal menu in mobile mode.\n             */\n            var mobilePersonalMenuListeners = function() {\n                /**\n                 * Get section left position and height.\n                 * @param {string} href\n                 * @returns {Object.<string, number>}\n                 */\n                var getSectionCoords = function(href) {\n                    var sections = $(\"#charteredcollege-pm-content section\");\n                    var sectionWidth = $(sections).outerWidth();\n                    var section = $(href);\n                    var selector = \"#charteredcollege-pm-updates section > div, #charteredcollege-pm-updates section > charteredcollege-feed > div\";\n                    var targetSection = $(selector).index(section) + 1;\n                    var position = sectionWidth * targetSection;\n                    var sectionHeight = $(href).outerHeight() + 200;\n\n                    // Course lists is at position 0.\n                    if (href == '#charteredcollege-pm-courses') {\n                        position = 0;\n                    }\n\n                    // Set the window height.\n                    var winHeight = $(window).height();\n                    if (sectionHeight < winHeight) {\n                        sectionHeight = winHeight;\n                    }\n                    return {left: position, height: sectionHeight};\n                };\n                // Personal menu small screen behaviour corrections on resize.\n                $(window).on('resize', function() {\n                    if (window.innerWidth >= 992) {\n                        // If equal or larger than Bootstrap 992 large breakpoint, clear left positions of sections.\n                        $('#charteredcollege-pm-content').removeAttr('style');\n\n                        if ($(\"#charteredcollege-pm-courses div#charteredcollege-personal-menu-intelliboard\").length > 0) {\n                            var section = $('div#charteredcollege-personal-menu-intelliboard').closest('section');\n                            section.prependTo('#charteredcollege-pm-updates');\n                        }\n                        if ($(\"#charteredcollege-pm-courses div#charteredcollege-personal-menu-intellicart\").length > 0) {\n                            var section = $('div#charteredcollege-personal-menu-intellicart').closest('section');\n                            section.prependTo('#charteredcollege-pm-updates');\n                        }\n                        return;\n                    }\n                    var activeLink = $('#charteredcollege-pm-mobilemenu a.state-active');\n                    if (!activeLink || !activeLink.length) {\n                        return;\n                    }\n\n                    if ($(\"#charteredcollege-pm-updates div#charteredcollege-personal-menu-intelliboard\").length > 0) {\n                        var section = $('div#charteredcollege-personal-menu-intelliboard').closest('section');\n                        section.appendTo('section#charteredcollege-pm-courses');\n                    }\n                    if ($(\"#charteredcollege-pm-updates div#charteredcollege-personal-menu-intellicart\").length > 0) {\n                        var section = $('div#charteredcollege-personal-menu-intellicart').closest('section');\n                        section.appendTo('section#charteredcollege-pm-courses');\n                    }\n\n                    var href = activeLink.attr('href');\n                    var posHeight = getSectionCoords(href);\n\n                    $('#charteredcollege-pm-content').css('left', '-' + posHeight.left + 'px');\n                    $('#charteredcollege-pm-content').css('height', posHeight.height + 'px');\n                });\n                // Personal menu small screen behaviour.\n                $(document).on(\"click\", '#charteredcollege-pm-mobilemenu a', function(e) {\n                    var href = this.getAttribute('href');\n                    var posHeight = getSectionCoords(href);\n\n                    $(\"html, body\").animate({scrollTop: 0}, 0);\n                    $('#charteredcollege-pm-content').animate({\n                            left: '-' + posHeight.left + 'px',\n                            height: posHeight.height + 'px'\n                        }, \"700\", \"swing\",\n                        function() {\n                            // Animation complete.\n                        });\n                    $('#charteredcollege-pm-mobilemenu a').removeClass('state-active');\n                    $(this).addClass('state-active');\n                    e.preventDefault();\n                });\n            };\n\n            /**\n             * Apply personal menu listeners.\n             */\n            var applyListeners = function() {\n                // On clicking personal menu trigger.\n                $(document).on(\"click\", \".js-charteredcollege-pm-trigger\", function(event) {\n                    $(\"html, body\").animate({scrollTop: 0}, 0);\n                    $('body').toggleClass('charteredcollege-pm-open');\n                    if ($('.charteredcollege-pm-open #charteredcollege-pm').is(':visible')) {\n                        self.update();\n                    }\n                    event.preventDefault();\n\n                    // Intelliboard and intellicart should be displayed under the courses on a small screen.\n                    if (window.innerWidth < 992) {\n                        if ($(\"#charteredcollege-pm-updates div#charteredcollege-personal-menu-intelliboard\").length > 0) {\n                            var section = $('div#charteredcollege-personal-menu-intelliboard').closest('section');\n                            section.appendTo('section#charteredcollege-pm-courses');\n                        }\n                        if ($(\"#charteredcollege-pm-updates div#charteredcollege-personal-menu-intellicart\").length > 0) {\n                            var section = $('div#charteredcollege-personal-menu-intellicart').closest('section');\n                            section.appendTo('section#charteredcollege-pm-courses');\n                        }\n                    }\n\n                    // If there is a message drawer, dispatch event to avoid opening both elements.\n                    if ($('.message-app.main').length === 0) {\n                        document.dispatchEvent(new Event(\"messages-drawer:pm-toggle\"));\n                    }\n                });\n\n                mobilePersonalMenuListeners();\n            };\n\n            /**\n             * Initialising function.\n             * @param {boolean} sitePolicyAcceptReqd\n             */\n            this.init = function(sitePolicyAcceptReqd) {\n                redirectToSitePolicy = sitePolicyAcceptReqd;\n                applyListeners();\n                if (!redirectToSitePolicy) {\n                    courseCards.init();\n                }\n            };\n        };\n\n        return new PersonalMenu();\n    }\n);\n"],"file":"personal_menu.min.js"}